<!doctype html><html lang=en-us><head><meta charset=utf-8><title>为什么一些统计服务的上报地址都是 gif 后缀?</title><meta name=description content><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=alternate type=application/rss+xml href=https://blog.isayme.org/index.xml title="BLOG - ISAYME"><meta name=twitter:card content="summary"><meta name=twitter:title content="为什么一些统计服务的上报地址都是 gif 后缀?"><meta name=twitter:description content="问题来源: 拼多多等 app，搜索请求地址是 t."><link rel=stylesheet href=https://blog.isayme.org/fontawesome/css/all.min.css><link crossorigin=anonymous href=/css/styles.min.css integrity rel="preload stylesheet" as=style><link rel=stylesheet href=https://blog.isayme.org/css/custom.css><link id=dark-mode-theme crossorigin=anonymous href=/css/dark.min.css integrity rel="preload stylesheet" as=style><script>var darkTheme=document.getElementById('dark-mode-theme')
var storedTheme=localStorage.getItem('dark-mode-storage')
if(storedTheme==='dark'){darkTheme.disabled=false}else if(storedTheme==='light'){darkTheme.disabled=true}</script><script defer crossorigin=anonymous src=/js/theme.js integrity></script><script defer crossorigin=anonymous src=/js/instantpage.min.js integrity></script><meta name=generator content="Hugo 0.78.1"></head><body><header><nav class=navbar><div class=nav><ul class=nav-links></ul></div></nav><div class=intro-header><div class=container><div class=posts-heading><h1>为什么一些统计服务的上报地址都是 gif 后缀?</h1></div></div></div></header><div class=container role=main><article class=article class=blog-post><blockquote><p>问题来源: <a href=https://www.v2ex.com/t/485592>拼多多等 app，搜索请求地址是 t.gif，这个什么原理？</a></p></blockquote><p>关键字: <code>image beacon</code>, <code>pixel tracking</code></p><p>之前也有注意到诸如 Google Analysis / 百度统计 的服务都会产生后缀是<code>gif</code>的请求, 但没有深究历史背景, 借此机会尝试去了解下.</p><h2 id=常见统计服务商的收集api>常见统计服务商的收集API</h2><h3 id=google-analysis>Google Analysis</h3><p>通过访问 <a href=http://twitter.com/>Twitter</a> 首页, 发现最新版的已经不是 gif, 但返回 gif 类型, 大小是 35 字节:
<img src=https://user-images.githubusercontent.com/1747852/45024469-ac175680-b06b-11e8-9784-dd3661850473.png alt=image></p><p>早期的 Google Analysis 也是 gif, 地址是 <a href=https://www.google-analytics.com/__utm.gif,>https://www.google-analytics.com/__utm.gif,</a> 35 字节.</p><h3 id=customerio>customer.io</h3><p>访问 <a href=https://customer.io>customer.io</a> 首页, 地址带有 gif 后缀, 返回 gif 类型, 36 字节.
<img src=https://user-images.githubusercontent.com/1747852/45025133-41ffb100-b06d-11e8-8ad7-9bb804e0fead.png alt=image></p><h3 id=友盟>友盟+</h3><p>访问 <a href=https://www.umeng.com/>友盟</a> 首页, 地址带有 gif 后缀, 返回 gif 类型, 43 字节.
<img src=https://user-images.githubusercontent.com/1747852/45024814-6d35d080-b06c-11e8-97cf-bdcb26ae9930.png alt=image></p><h3 id=百度统计>百度统计</h3><p>访问 <a href=https://www.teambition.com>Teambition</a> 首页, 使用了百度统计, 地址带有 gif 后缀, 返回 gif 类型, 43 字节.
<img src=https://user-images.githubusercontent.com/1747852/45024989-d7e70c00-b06c-11e8-832e-5d13f5c8c95b.png alt=image></p><h2 id=微博>微博</h2><p>访问 <a href=https://weibo.com>微博</a> 首页, 收集地址带有 gif 后缀, 返回 gif 类型, 35 字节
<img src=https://user-images.githubusercontent.com/1747852/45025832-2dbcb380-b06f-11e8-92dd-570f352e997d.png alt=image></p><h3 id=简单总结>简单总结</h3><p>目前大多数统计的请求地址是带有<code>gif</code>后缀的, 接口返回一个 1x1 尺寸的 gif 图片,大小 35/36/43 字节.</p><h2 id=问题及解释>问题及解释</h2><h3 id=使用-gif-后缀的传统是哪来的>使用 <code>gif</code> 后缀的传统是哪来的?</h3><p>最早的猜测是 Google Analysis.</p><h3 id=为什么是图片-为什么是-gif-而不是其他格式>为什么是图片? 为什么是 <code>gif</code> 而不是其他格式?</h3><p>图片的优势:</p><ol><li>不阻塞页面加载;</li><li>自动触发;</li><li>可以内嵌到邮件中(邮件不支持javascript; 邮件的阅读统计需求);</li><li>没有跨域问题.</li></ol><p><code>gif</code> 的优势:</p><ol><li>1x1的尺寸够小(最小35字节);</li><li>出生早(<a href=https://en.wikipedia.org/wiki/GIF>gif:1987/1989</a>, <a href=https://en.wikipedia.org/wiki/JPEG>jpeg:1992</a>, <a href=https://en.wikipedia.org/wiki/Portable_Network_Graphics>png: 1996</a>);</li><li>浏览器支持更广泛<a href=https://en.wikipedia.org/wiki/Comparison_of_web_browsers#Image_format_support>Image format support</a></li></ol><h3 id=同样是-1x1-的尺寸-为什么大小不一样>同样是 <code>1x1</code> 的尺寸, 为什么大小不一样?</h3><p>35/36字节的gif: 是1x1像素的白色图片;
43字节的gif: 是1x1像素的透明图片;</p><h2 id=参考资料>参考资料</h2><ul><li><a href=http://blog.codinglabs.org/articles/how-web-analytics-data-collection-system-work.html>网站统计中的数据收集原理及实现</a></li><li><a href=https://yq.aliyun.com/articles/69313>CORS——跨域请求那些事儿</a></li><li><a href=https://en.wikipedia.org/wiki/Web_beacon>Wiki: Web beacon</a></li><li><a href=https://stackoverflow.com/questions/2083043/why-does-google-analytic-request-a-gif-file>Why does Google Analytic request a GIF file?</a></li><li><a href=https://stackoverflow.com/questions/4170190/why-does-google-analytics-use-utm-gif>Why does Google Analytics use __utm.gif?</a></li><li><a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS>Cross-Origin Resource Sharing (CORS)</a></li><li><a href=https://developer.mozilla.org/en-US/docs/Web/API/Navigator/sendBeacon>Navigator.sendBeacon()</a></li><li><a href=http://arlocarreon.com/blog/javascript/javascript-image-beacons-for-tracking-user-interactions/>Javascript Image Beacons For Tracking User Interactions</a></li><li><a href=https://perso.crans.org/besson/beacon.en.html>How to use Google Analytics with a beacon image</a></li><li><a href=https://www.sitepoint.com/using-beacon-image-github-website-email-analytics/>Using a Beacon Image for GitHub, Website and Email Analytics</a></li></ul></article></div><footer><div class=social-icons></div><div class=container><p class="credits copyright"><a href=https://blog.isayme.org/about></a>&nbsp;&copy;
2024
&nbsp;/&nbsp;
<a href=https://blog.isayme.org/>BLOG - ISAYME</a>
&nbsp;&ndash;&nbsp;
<em class="fas fa-moon" id=dark-mode-toggle></em></p><p class="credits theme-by">Powered By <a href=https://gohugo.io>Hugo</a>&nbsp;
Theme
<a href=https://github.com/matsuyoshi30/harbor>Harbor</a></p></div></footer></body></html>